kb_id,title,category,platform,attack_type,tags,severity_min,triggers,summary,steps,what_to_check,escalate_if,references
KB-001,Scheduled Task Persistence Detection,Persistence,Windows,Scheduled Task Creation,"persistence,scheduled_task,lateral_movement",medium,"schtasks.exe,at.exe,TaskScheduler API calls,registry key HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache","Adversary creates scheduled task for persistence or privilege escalation using schtasks.exe or COM objects","1. Identify the account that created the task and verify legitimacy. 2. Review task XML for suspicious triggers (logon/startup/hourly). 3. Analyze the executable path and command-line arguments. 4. Check parent process of schtasks.exe (should be admin tools not cmd.exe/powershell). 5. Correlate with recent authentication events from same user. 6. Search for similar tasks across environment using SIEM query","Task name in \Microsoft\Windows\ root with random names,Task running from temp/public/AppData locations,Base64 encoded commands in task actions,Tasks running as SYSTEM created by non-admin users,Executable paths pointing to webshell locations or writable directories","Task executes known malware hash,Multiple endpoints show identical suspicious tasks within short timeframe,Task created during confirmed compromise window,Command line contains lateral movement tools (psexec/wmic/powershell remoting)","MITRE ATT&CK T1053.005,Microsoft Scheduled Tasks Documentation"
KB-002,LSASS Memory Dumping,Credential Access,Windows,LSASS Credential Dumping,"credentials,mimikatz,procdump,lsass",critical,"Process access to lsass.exe,MiniDumpWriteDump API,comsvcs.dll rundll32,ProcDump execution,Task Manager dump creation","Attacker attempts to dump LSASS process memory to extract credentials including NTLM hashes and Kerberos tickets","1. Identify the process and user that accessed lsass.exe memory. 2. Check if process is legitimate admin tool (ProcDump/Task Manager) or suspicious (rundll32/powershell). 3. Verify if dump file was created and its current location. 4. Review parent process chain for indicators of remote execution. 5. Check for subsequent suspicious authentication attempts from same host. 6. Isolate endpoint immediately if confirmed malicious","Non-admin user accessing lsass.exe,Processes like rundll32.exe comsvcs.dll MiniDump or powershell with sekurlsa,Dump files in unusual locations (%temp%/public folders/web directories),Access from recently compiled executable or script,Network logon immediately before dump attempt","Confirmed dump file exfiltration detected,Multiple privilege escalation attempts follow the dump,Lateral movement to domain controllers within 1 hour of dump,Known APT tool hashes (mimikatz/Invoke-Mimikatz) detected,Admin account compromise confirmed post-dump","MITRE ATT&CK T1003.001,SANS LSASS Protection Guide"
KB-003,AWS IAM Privilege Escalation,Privilege Escalation,Cloud - AWS,IAM Policy Manipulation,"cloud,aws,iam,privilege_escalation",high,"iam:PutUserPolicy,iam:PutGroupPolicy,iam:AttachUserPolicy,iam:CreateAccessKey,iam:UpdateAssumeRolePolicy","Unauthorized modification of IAM policies to grant excessive permissions or create backdoor access","1. Identify the principal (user/role) that made IAM changes via CloudTrail. 2. Review policy changes for overly permissive actions (*:* or admin policies). 3. Check if new access keys were created for compromised accounts. 4. Verify source IP and user-agent against known admin workstations. 5. List all affected users/roles and their current permissions. 6. Search for subsequent resource access using elevated privileges","Policy attachments granting AdministratorAccess or PowerUserAccess,Inline policies with wildcard permissions,Access key creation outside business hours,API calls from unfamiliar IP ranges or countries,Assume role policy modifications allowing external accounts,Rapid succession of IAM changes (automation indicator)","IAM changes followed by data exfiltration (S3 GetObject spike),Cross-account assume role to unknown AWS account,Creation of new IAM users with admin policies,EC2 instance launches in unused regions post-escalation,Deletion of CloudTrail logs or GuardDuty detectors","MITRE ATT&CK T1078.004,AWS IAM Security Best Practices,Rhino Security Labs IAM Privilege Escalation"
KB-004,Web Shell Upload Detection,Initial Access,Web Server,Webshell Deployment,"webshell,iis,apache,nginx,upload",critical,"File creation in web directories,Suspicious file extensions (.aspx/.jsp/.php in uploads),POST requests to recently created files,Outbound connections from web server processes","Attacker uploads web shell to gain remote command execution on web server","1. Identify the uploaded file path and review file contents for web shell signatures. 2. Check web server logs for upload request (POST with file upload). 3. Determine authentication status of uploader (anonymous vs authenticated). 4. Review all HTTP requests to the suspicious file. 5. Check for outbound network connections from w3wp.exe/httpd/nginx. 6. Search for additional files uploaded in same directory or timeframe","Files with double extensions (image.jpg.php),Obfuscated PHP/ASPX code with eval/base64_decode,File names matching known shells (c99.php/b374k/china chopper),Upload directory containing executable code,Web server process spawning cmd.exe/powershell.exe/bash,Requests with suspicious parameters (?cmd=/?action=/pass=)","Web shell confirmed functional via successful command execution,Internal network reconnaissance detected from web server,Privilege escalation or credential dumping on web server host,Data exfiltration from database through web shell,Multiple compromised servers with identical web shells","MITRE ATT&CK T1505.003,OWASP Web Shell Detection,NSA Web Shell Indicators"
KB-005,Supply Chain DLL Injection,Execution,Windows,DLL Side-Loading,"supply_chain,dll_hijacking,sideloading,trusted_binary",high,"Legitimate signed binary loading unsigned DLL,DLL loaded from non-standard path,Known vulnerable applications,Missing DLL search order exploitation","Attacker exploits trusted application to load malicious DLL from writable directory instead of legitimate system DLL","1. Identify the legitimate executable and the suspicious DLL it loaded. 2. Compare DLL path against expected installation directory. 3. Check DLL signature and publisher (should match parent application). 4. Review DLL export functions for malicious capabilities. 5. Search for same DLL name loaded across multiple systems. 6. Investigate how DLL arrived on system (download/lateral movement/USB)","Signed Microsoft/vendor binary loading DLL from temp/public/AppData,DLL version mismatch with expected system DLL,Recent modification timestamp on DLL vs parent executable,Parent process launched from unusual location,DLL missing digital signature when system version is signed,Known hijackable applications (OneDrive/Teams/Zoom) loading unexpected modules","Confirmed malware family associated with DLL hash,Network C2 communication observed from hijacked process,Multiple endpoints exhibiting same DLL loading pattern,DLL persistence mechanism detected (registry/scheduled task),Credential theft or lateral movement follows DLL execution","MITRE ATT&CK T1574.002,LOLBAS DLL Hijacking,Mandiant DLL Side-Loading Report"
KB-006,DNS Tunneling Data Exfiltration,Exfiltration,Network,DNS Tunneling,"exfiltration,dns,tunneling,c2",high,"Excessive DNS queries to single domain,Long DNS subdomain queries (>50 chars),High entropy in DNS requests,Unusual DNS record types (TXT/NULL),Non-standard DNS port usage","Attacker encodes data in DNS queries to exfiltrate information or establish C2 channel bypassing firewall restrictions","1. Identify source host generating suspicious DNS traffic. 2. Extract queried domain and analyze subdomain patterns for Base64/hex encoding. 3. Calculate query volume and frequency from source IP. 4. Check if domain is newly registered or has low reputation. 5. Analyze DNS response sizes and record types. 6. Review recent file access on source host for sensitive data. 7. Capture full DNS session for traffic analysis","Subdomain length >40 characters with random appearance,Query rate >100/min to single domain,High Shannon entropy in subdomains (>3.5),DNS TXT record responses containing large payloads,Queries to domains with short TTL values,Source host has sensitive data access (file servers/databases/domain controllers)","Confirmed sensitive data encoded in DNS queries,Domain infrastructure linked to known APT groups,Multiple internal hosts querying same suspicious domain,Data exfiltration volume exceeds 100MB based on query count,DNS traffic persists after initial blocking (domain generation algorithm)","MITRE ATT&CK T1048.003,SANS DNS Tunneling Detection,Cisco DNS Tunneling Analysis"
KB-007,Malware C2 Beacon Detection,Command and Control,Network,C2 Communication,"c2,beacon,malware,callback",critical,"Periodic outbound connections,Connections to newly registered domains,High-frequency callbacks,SSL certificate anomalies,JA3 hash matches known malware","Malware establishes command and control channel with attacker infrastructure using beacon patterns","1. Identify internal host initiating C2 communication. 2. Analyze connection frequency for beacon intervals (every 60s/5min/hourly). 3. Check destination IP/domain reputation and registration date. 4. Review SSL certificate details for self-signed or suspicious issuers. 5. Examine process establishing connection and parent process chain. 6. Check host for signs of compromise (autoruns/scheduled tasks/services). 7. Capture network traffic for protocol analysis","Connections every fixed interval (60s/300s/3600s) with jitter,Domain registered within last 30 days,SSL certificate with short validity period or mismatched CN,Process is not standard browser/updater,Destination IP in known bullet-proof hosting ranges,User-agent strings not matching OS version,HTTP POST to root path with no GET requests","Malware sample confirmed via endpoint detection,Lateral movement detected from infected host,Data staging or exfiltration observed,Multiple hosts beaconing to same C2 infrastructure,C2 domain linked to active campaign or APT group","MITRE ATT&CK T1071,FireEye C2 Beacon Analysis,Palo Alto C2 Detection Techniques"
KB-008,Linux Privilege Escalation via SUID,Privilege Escalation,Linux,SUID Exploitation,"linux,privilege_escalation,suid,unix",high,"Execution of SUID binaries,Kernel exploit attempts,Sudo misconfiguration abuse,Capability exploitation,SUID binary modification","Attacker exploits SUID/SGID binaries or sudo misconfigurations to escalate from standard user to root privileges","1. Identify which SUID binary was executed and by which user. 2. Check if binary is standard system tool or custom application. 3. Review sudo configuration (/etc/sudoers) for NOPASSWD entries. 4. Check for recent modifications to SUID binaries (find / -perm -4000). 5. Analyze command history for privilege escalation enumeration. 6. Review /var/log/auth.log for sudo attempts and failures. 7. Check if new users were added to sudo/wheel group","SUID binary executed from writable directory (/tmp/var/tmp),Known vulnerable binaries (nmap/vim/find/awk with SUID),Sudo rules allowing shell escapes (vim/less/man NOPASSWD),Recent compilation of exploits (gcc/python in user history),File capabilities granting excessive privileges,Kernel exploits (dirtycow/overlayfs) attempted","Root shell spawned confirmed via process monitoring,New root account created or existing account elevated,Critical system files modified (/etc/passwd/shadow/sudoers),Lateral movement using root credentials,Persistence mechanisms installed (cron/SSH keys/backdoor binaries)","MITRE ATT&CK T1548.001,GTFOBins SUID,Linux Privilege Escalation Guide"
KB-009,Ransomware File Encryption,Impact,Windows,Data Encryption,"ransomware,encryption,impact,file_modification",critical,"High volume file modifications,File extension changes (.locked/.encrypted),Shadow copy deletion,Backup service termination,Ransom note creation","Ransomware encrypts files and demands payment while deleting backups and shadow copies to prevent recovery","1. Identify patient zero host with earliest encryption activity. 2. Isolate affected systems immediately from network. 3. Document ransom note content and file extension used. 4. Check if shadow copies were deleted (vssadmin delete shadows). 5. Verify backup integrity and offline backup availability. 6. Identify ransomware family via note/extension/TTPs. 7. Map lateral movement path to determine entry point. 8. DO NOT pay ransom without executive approval","File modification rate >1000 files/min,Vssadmin.exe delete shadows command,Backup service stopped (Windows Backup/Veeam/Acronis),File extensions changed to .locked/.encrypted/.ransom,Ransom notes (README.txt/HOW_TO_DECRYPT) in directories,Encryption binary executed from temp/AppData,Network shares with massive file modifications","Multiple hosts encrypted simultaneously,Domain controller or backup server encrypted,Critical production systems affected,No viable backups available,Ransomware group known for data exfiltration (double extortion),Decryption key not available from public sources","MITRE ATT&CK T1486,CISA Ransomware Guide,ID Ransomware Database,No More Ransom Project"
KB-010,Backup Deletion and Tampering,Impact,Windows/Linux,Backup Destruction,"backup,deletion,impact,recovery_prevention",critical,"Vssadmin delete shadows,wbadmin delete catalog,bcdedit bootstatuspolicy ignoreallfailures,Backup file deletion,Volume shadow service stopped","Attacker deletes system backups and shadow copies to prevent recovery before deploying ransomware or wiping systems","1. Identify account executing backup deletion commands. 2. Check if VSS service was stopped or disabled. 3. Verify if Windows backup catalog was deleted. 4. Review backup storage locations for file deletions. 5. Check offsite/cloud backup integrity. 6. Determine if bootloader was modified (bcdedit commands). 7. Search for similar activity across environment","Commands: vssadmin delete shadows /all /quiet,wbadmin delete catalog -quiet,bcdedit /set {default} recoveryenabled no,Backup files deleted from network shares or local storage,VSS service disabled via sc config VSS start=disabled,Activity occurs 0-4 hours before ransomware deployment,Executed via PsExec or other lateral movement tools","Backup deletion on multiple critical servers,Domain controller backup compromised,All local and network backup copies deleted,Activity followed by ransomware deployment,No offline or immutable backups exist,Deletion spans multiple backup solutions (Veeam/Commvault/Backup Exec)","MITRE ATT&CK T1490,CISA Backup Security Guidance,Veeam Ransomware Protection"
KB-011,Azure AD Privilege Escalation,Privilege Escalation,Cloud - Azure,Azure AD Role Assignment,"azure,aad,cloud,privilege_escalation,rbac",high,"Add member to privileged role,Grant application permissions,Service principal privilege changes,PIM role activation,Custom role creation","Unauthorized elevation of Azure AD privileges through role assignments or application permission grants","1. Identify principal that made role assignment via Azure AD audit logs. 2. Review which role was granted (Global Admin/Privileged Role Admin). 3. Check if role assignment was permanent or PIM-eligible. 4. Verify source IP and user-agent against known admin workstations. 5. Review recent activity of newly privileged account. 6. Check for application permission grants (Graph API/Exchange). 7. List all members of privileged roles for anomalies","Assignment to Global Administrator or Privileged Role Administrator,Application granted Mail.ReadWrite or Directory.ReadWrite.All,Service principal given excessive permissions,PIM activation outside business hours,Custom roles with wildcard permissions,Multiple role assignments in rapid succession","Role assignment followed by mass data access,New application registered with admin consent,Password reset on privileged accounts,MFA disabled on admin accounts,Cross-tenant synchronization configured,Bulk user/group modifications post-escalation","MITRE ATT&CK T1078.004,Microsoft Azure AD Security,AADInternals Attack Techniques"
KB-012,SQL Injection to RCE,Initial Access,Database,SQL Injection with Code Execution,"sqli,rce,database,web_attack",critical,"xp_cmdshell execution,OPENROWSET usage,SQL error messages in web logs,Union-based injection patterns,Bulk insert from external sources","Attacker exploits SQL injection vulnerability to execute operating system commands on database server","1. Identify web application and vulnerable parameter from WAF/IDS logs. 2. Review SQL server logs for xp_cmdshell or sp_OACreate execution. 3. Extract attacker's SQL commands from application logs. 4. Check if xp_cmdshell was enabled during the attack. 5. Review OS command execution results and actions taken. 6. Identify database account used (sa vs application account). 7. Check for data exfiltration via OPENROWSET or bulk operations","SQL errors in web application logs (syntax errors/union queries),xp_cmdshell enabled on SQL server,Commands executed via xp_cmdshell (whoami/net user/powershell),OPENROWSET queries to external servers,Application database account has sysadmin role,Web requests with SQL keywords (union/select/exec/cast)","RCE confirmed via command execution,Credential dumping from SQL server,Lateral movement from database server,Web shell uploaded to web root via SQL,Sensitive database tables accessed or exfiltrated,Attack originated from public internet (not authenticated users)","MITRE ATT&CK T1190,OWASP SQL Injection,Microsoft SQL Server Security,PortSwigger SQL Injection Guide"
KB-013,Kubernetes Pod Escape,Privilege Escalation,Container,Container Escape,"kubernetes,container,escape,docker",critical,"Privileged pod creation,HostPath volume mounts,Nsenter execution,CAP_SYS_ADMIN capability,Docker socket mount","Attacker escapes container to access underlying Kubernetes node or cluster","1. Identify pod with privileged settings or host mounts via kubectl get pods -o json. 2. Review pod security context for privileged:true or hostPID:true. 3. Check for mounted volumes especially /var/run/docker.sock or host paths. 4. Examine container capabilities for CAP_SYS_ADMIN. 5. Review Kubernetes audit logs for pod creation/modification. 6. Check if service account has excessive RBAC permissions. 7. Investigate commands executed inside suspicious containers","Privileged: true in pod spec,HostPath mounts to / or /var/run/docker.sock,Container capabilities include SYS_ADMIN or SYS_PTRACE,Pod running as root (runAsUser:0),Service account with cluster-admin binding,Nsenter or chroot executed inside container,Node filesystem accessible from container","Confirmed node access from container,Secrets extracted from etcd,Privilege escalation to cluster-admin,Multiple nodes compromised,Cryptomining deployed cluster-wide,Control plane access achieved","MITRE ATT&CK T1611,Kubernetes Security Best Practices,CIS Kubernetes Benchmark,Aqua Container Escape Techniques"
KB-014,Office 365 Inbox Rule Manipulation,Collection,Cloud - Office 365,Email Forwarding Rules,"o365,email,forwarding,persistence",high,"New-InboxRule with forwarding,Set-InboxRule modifications,Rules forwarding to external domains,Hidden inbox rules,Suspicious rule names","Attacker creates email forwarding rules to exfiltrate emails or maintain persistence after credential compromise","1. Identify affected mailbox and rule creation timestamp via O365 audit logs. 2. Review rule conditions (from/subject/body keywords) and actions (forward/delete/move). 3. Check forwarding destination addresses for external domains. 4. Verify if rule is hidden (rule created via PowerShell not Outlook). 5. Review recent sign-in activity for compromised account. 6. Check for data access post-rule creation (MailItemsAccessed). 7. Search for similar rules across tenant","Rules forwarding to external domains (gmail/outlook/protonmail),Rules with 'StopProcessingRules:true' (hides from Outlook),Rule names: . or blank or random characters,Rules created via PowerShell New-InboxRule,Forwarding targeting CEO/CFO/Finance emails,Rules deleting after forwarding to hide evidence,Creation within 24hrs of suspicious sign-in","Confirmed account compromise with impossible travel,Sensitive emails forwarded (finance/legal/executive),Multiple mailboxes with identical forwarding rules,External domain linked to known phishing campaign,MFA disabled or legacy auth used,Business Email Compromise indicators present","MITRE ATT&CK T1114.003,Microsoft Email Forwarding Detection,FBI BEC Advisory"
KB-015,WMI Persistence,Persistence,Windows,WMI Event Subscription,"wmi,persistence,event_subscription,fileless",high,"WMI event consumer creation,__EventFilter creation,__FilterToConsumerBinding,ActiveScriptEventConsumer,CommandLineEventConsumer","Attacker uses WMI event subscriptions for fileless persistence that survives reboots","1. Enumerate all WMI event subscriptions: Get-WMIObject -Namespace root\subscription -Class __EventFilter. 2. Review __EventConsumer for suspicious command execution or scripts. 3. Check __FilterToConsumerBinding for active subscriptions. 4. Analyze EventFilter query for trigger conditions (time/process/logon). 5. Investigate consumer payload (VBScript/PowerShell commands). 6. Search for similar WMI persistence across environment. 7. Check WMI activity logs (Microsoft-Windows-WMI-Activity/Operational)","CommandLineEventConsumer with encoded PowerShell,ActiveScriptEventConsumer with VBScript downloading payloads,Event filters triggering on logon or specific times,Consumer names with random characters or system-looking names,WMI subscriptions in unusual namespaces,Subscription created by non-admin or compromised account,Payload executes from temp/public/AppData directories","WMI persistence on domain controller,Multiple endpoints with identical WMI subscriptions,Consumer executes known malware or C2 tool,Subscription created during confirmed breach window,Fileless malware delivered via WMI,Lateral movement evidence from subscribing host","MITRE ATT&CK T1546.003,FireEye WMI Offense and Defense,Microsoft WMI Architecture"
KB-016,GCP Cloud Storage Data Exfiltration,Exfiltration,Cloud - GCP,Storage Bucket Access,"gcp,storage,exfiltration,bucket",high,"storage.objects.list on sensitive buckets,storage.objects.get excessive calls,Bucket policy changes to allUsers,Service account key creation,gsutil cp to external locations","Unauthorized access to GCP Cloud Storage buckets with bulk download or permission changes","1. Identify principal accessing storage buckets via Cloud Audit Logs. 2. Review which buckets were accessed and object count. 3. Check for bucket permission changes (allUsers/allAuthenticatedUsers). 4. Verify source IP against known GCP IP ranges and expected locations. 5. Calculate data volume accessed (GetObject request sizes). 6. Review service account key creation events. 7. Check for bucket-to-bucket transfers to attacker-controlled projects","Bucket permissions changed to public (allUsers),Excessive storage.objects.get (>1000 in 1 hour),Service account key created then immediately used,Access from unexpected GCP project,gsutil or gcloud commands from unusual sources,IAM binding granting storage.admin to new principals,Bucket lifecycle policies modified to prevent deletion","Data volume exceeds 100GB in single session,Sensitive buckets accessed (PII/financial/credentials),Cross-project data transfer detected,Service account key exfiltrated and used externally,Public bucket configuration exposed sensitive data,Multiple projects showing similar exfiltration patterns","MITRE ATT&CK T1530,GCP Storage Security Best Practices,Google Cloud Audit Logs Guide"
KB-017,Kerberos Golden Ticket Attack,Credential Access,Windows,Kerberos Ticket Forgery,"kerberos,golden_ticket,krbtgt,domain_persistence",critical,"TGT with unusual lifetime,Kerberos tickets for disabled accounts,RC4 encryption in TGT when AES expected,KRBTGT account password access,Mimikatz DCSync operations","Attacker forges Kerberos TGT using compromised KRBTGT hash to gain persistent domain access","1. Review Kerberos Event 4769 for tickets with lifetime >10 hours. 2. Check for RC4_HMAC encryption when domain uses AES256. 3. Identify accounts using forged tickets (especially disabled accounts). 4. Review DCSync events (replication from non-DC) targeting KRBTGT. 5. Check for anomalous service ticket requests from unusual sources. 6. Analyze authentication patterns from suspected golden ticket. 7. Review domain controller security logs for KRBTGT hash access","Kerberos tickets with 10 year lifetime,Disabled accounts successfully authenticating,RC4 encryption tickets in AES-only domain,Account authenticating from multiple IPs simultaneously,Service tickets requested for services that don't exist,TGTs issued outside of normal KDC process,Events 4768/4769 for service accounts outside business hours","Domain controller compromise confirmed,KRBTGT hash extracted via DCSync or LSASS dump,Authentication to critical systems with forged tickets,Lateral movement using golden ticket,Multiple privileged accounts accessed with same ticket,Evidence of domain-wide persistence mechanism","MITRE ATT&CK T1558.001,SANS Golden Ticket Detection,Microsoft Kerberos Security,Detect and Mitigate Golden Ticket"
KB-018,Cloud VM Instance Hijacking,Resource Hijacking,Cloud - Multi,Cryptomining via Cloud Compute,"cryptomining,cloud,compute,resource_hijacking",high,"High CPU usage on VM instances,Outbound connections to mining pools,Unauthorized instance launches,SSH key modifications,Instance metadata changes","Attacker launches or hijacks cloud VM instances for cryptocurrency mining operations","1. Identify instances with sustained 100% CPU usage via cloud monitoring. 2. Review instance creation logs for unauthorized launches. 3. Check outbound network connections for mining pool IPs (port 3333/4444/8080). 4. Analyze running processes for mining software (xmrig/ccminer/ethminer). 5. Review instance metadata for SSH key additions. 6. Check IAM logs for compute.instances.create permissions usage. 7. Calculate cost impact from unauthorized resource usage","CPU sustained at 90-100% on instances,Network connections to known mining pools (stratum+tcp://),Instance types changed to compute-optimized (AWS c5/GCP c2),Instances launched in unused regions,SSH keys added to instance metadata,Processes: xmrig/minerd/ccminer running,Spot/preemptible instances launched en masse","Monthly cloud bill increase >500%,Mining detected on production instances,Hundreds of instances launched simultaneously,Service account credentials compromised,Mining operation spans multiple cloud providers,Instance snapshots taken before mining deployment","MITRE ATT&CK T1496,AWS Cryptomining Detection,Google Cloud Security Response,Cloud Cryptomining Indicators"
KB-019,Active Directory ACL Manipulation,Persistence,Windows,AD Permission Backdoor,"active_directory,acl,persistence,dcsync",high,"GenericAll/WriteDacl/WriteOwner granted,DCSync permissions added,AdminSDHolder modifications,Sensitive object ACL changes,Unexpected replication permissions","Attacker modifies Active Directory ACLs to grant themselves persistence and privilege escalation paths","1. Review AD audit logs for ACL modifications (Event 5136). 2. Enumerate objects with GenericAll/WriteDacl for unexpected trustees. 3. Check for users granted DS-Replication-Get-Changes (DCSync rights). 4. Review AdminSDHolder object ACL for backdoors. 5. Identify which account made the ACL change and verify legitimacy. 6. Check for shadow credentials or resource-based constrained delegation. 7. Search for similar ACL changes across domain","GenericAll granted to standard user account on domain objects,DS-Replication-Get-Changes granted to non-DC computer,WriteDacl permission added to AdminSDHolder,ACL changes to Domain Admins or Enterprise Admins groups,Permissions granted to service accounts or old unused accounts,Shadow credentials added to privileged accounts,ACL modifications outside change control windows","ACL backdoor on domain controllers,DCSync permissions used to dump credentials,AdminSDHolder modifications allowing persistent admin access,Multiple privilege escalation paths created,ACL changes during active incident,Shadow credentials used for authentication bypass","MITRE ATT&CK T1222.001,Bloodhound AD Attack Paths,Microsoft AD ACL Security,SpecterOps AD Security"
KB-020,Log Deletion and Tampering,Defense Evasion,Windows/Linux,Audit Log Clearing,"log_deletion,defense_evasion,antiforensics,audit_bypass",high,"wevtutil clear-log,Clear-EventLog,rm /var/log,auditpol disable,EventLog service stopped","Attacker clears or disables security logs to hide malicious activity and frustrate incident response","1. Check for Event 1102 (Security log cleared) and 104 (System log cleared). 2. Identify account that cleared logs and source host. 3. Review if entire log was cleared or selective events deleted. 4. Check for EventLog service stops (Event 1100). 5. Verify if auditpol was used to disable specific audit categories. 6. Review backup copies or SIEM for logs before deletion. 7. Check for similar log clearing across environment (lateral movement indicator)","Event 1102: Security log cleared by [account],wevtutil cl Security/System/Application,Clear-EventLog PowerShell cmdlet,Linux: rm -rf /var/log/* or > /var/log/auth.log,Windows EventLog service stopped via sc stop EventLog,Audit policy disabled: auditpol /set /category:* /success:disable,Log clearing 0-2 hours after initial compromise","Logs cleared on multiple critical systems,Domain controller logs tampered with,Log deletion followed by ransomware deployment,SIEM forwarding disabled before log clearing,All forensic artifacts destroyed (logs/prefetch/USN journal),Logs cleared during confirmed active breach","MITRE ATT&CK T1070.001,SANS Log Analysis,Windows Event Log Security,Linux Audit Best Practices"
